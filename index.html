<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Roleta do Felipe</title>

<style>

body{
    margin:0;
    font-family: Arial;
    background: radial-gradient(circle, #0f2027, #203a43, #2c5364);
    color:white;
    text-align:center;
}

h1{
    text-shadow:0 0 15px cyan;
}

textarea{
    width:90%;
    max-width:300px;
    height:100px;
    font-size:16px;
    border-radius:10px;
    padding:10px;
}

button{
    margin:5px;
    padding:10px 15px;
    font-size:16px;
    border:none;
    border-radius:10px;
    background:cyan;
    cursor:pointer;
}

canvas{
    width:90%;
    max-width:350px;
    background:black;
    border-radius:50%;
    box-shadow:0 0 20px cyan;
}

#seta{
    font-size:40px;
}

.nomeBtn{
    display:block;
    margin:3px auto;
    background:red;
    color:white;
}

.confete{
    position:fixed;
    width:10px;
    height:10px;
    top:-10px;
    animation:cair 3s linear forwards;
}

@keyframes cair{
    to{
        transform:translateY(100vh) rotate(720deg);
    }
}

</style>

</head>
<body>

<h1>üéØ Roleta do Felipe</h1>

<textarea id="nomes"></textarea><br>

<button onclick="salvar()">Salvar nomes</button>
<button onclick="girar()">Girar</button>
<button onclick="resetar()">Reset</button>

<div id="seta">‚¨á</div>

<canvas id="canvas" width="400" height="400"></canvas>

<h3>üèÜ Vencedores:</h3>
<div id="vencedores"></div>

<h3>‚ùå Remover nome:</h3>
<div id="remover"></div>

<audio id="tic">
<source src="https://www.soundjay.com/mechanical/sounds/mechanical-clonk-1.mp3">
</audio>

<audio id="win">
<source src="https://www.soundjay.com/human/sounds/applause-01.mp3">
</audio>

<script>

const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");

let nomes=[];
let rotacao=0;
let girando=false;

const cores=["red","blue","green","yellow","purple","orange","cyan"];

function salvar(){

let texto=document.getElementById("nomes").value;

nomes=texto.split("\n").filter(n=>n.trim()!="");

localStorage.setItem("nomes",JSON.stringify(nomes));

desenhar();
mostrarRemover();

}

function carregar(){

let salvo=localStorage.getItem("nomes");

if(salvo){

nomes=JSON.parse(salvo);

document.getElementById("nomes").value=nomes.join("\n");

desenhar();
mostrarRemover();

}

}

function desenhar(){

if(nomes.length==0) return;

let ang=2*Math.PI/nomes.length;

ctx.clearRect(0,0,400,400);

for(let i=0;i<nomes.length;i++){

ctx.beginPath();
ctx.moveTo(200,200);
ctx.arc(200,200,200,i*ang,(i+1)*ang);

ctx.fillStyle=cores[i%cores.length];
ctx.fill();

ctx.save();

ctx.translate(200,200);
ctx.rotate(i*ang+ang/2);

ctx.fillStyle="white";
ctx.fillText(nomes[i],80,5);

ctx.restore();

}

}

function girar(){

if(girando||nomes.length==0)return;

girando=true;

let tic=setInterval(()=>{
document.getElementById("tic").play();
},200);

let indice=Math.floor(Math.random()*nomes.length);

let angulo=360/nomes.length;

let destino=270-(indice*angulo);

rotacao+=360*5+destino;

canvas.style.transition="4s";
canvas.style.transform="rotate("+rotacao+"deg)";

setTimeout(()=>{

clearInterval(tic);

let vencedor=nomes[indice];

document.getElementById("win").play();

document.getElementById("vencedores").innerHTML+=vencedor+"<br>";

confete();

nomes.splice(indice,1);

localStorage.setItem("nomes",JSON.stringify(nomes));

desenhar();

mostrarRemover();

girando=false;

},4000);

}

function confete(){

for(let i=0;i<100;i++){

let c=document.createElement("div");

c.className="confete";

c.style.left=Math.random()*100+"vw";

c.style.background=cores[Math.floor(Math.random()*cores.length)];

c.style.animationDuration=(Math.random()*3+2)+"s";

document.body.appendChild(c);

setTimeout(()=>c.remove(),5000);

}

}

function resetar(){

localStorage.removeItem("nomes");

nomes=[];

document.getElementById("nomes").value="";

document.getElementById("vencedores").innerHTML="";

document.getElementById("remover").innerHTML="";

ctx.clearRect(0,0,400,400);

}

function mostrarRemover(){

let div=document.getElementById("remover");

div.innerHTML="";

nomes.forEach((nome,i)=>{

let btn=document.createElement("button");

btn.innerText=nome;

btn.className="nomeBtn";

btn.onclick=()=>{

nomes.splice(i,1);

localStorage.setItem("nomes",JSON.stringify(nomes));

desenhar();

mostrarRemover();

};

div.appendChild(btn);

});

}

carregar();

</script>

</body>
</html>
