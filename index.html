<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Roleta Profissional do Felipe</title>

<style>

body{
margin:0;
background:radial-gradient(circle,#0f2027,#203a43,#2c5364);
color:white;
font-family:Arial;
text-align:center;
}

h1{
text-shadow:0 0 20px cyan;
}

textarea{
width:300px;
height:120px;
border-radius:10px;
padding:10px;
font-size:16px;
}

button{
padding:10px 15px;
margin:5px;
font-size:16px;
border:none;
border-radius:10px;
background:cyan;
cursor:pointer;
font-weight:bold;
}

#container{
position:relative;
display:inline-block;
}

#seta{
position:absolute;
left:50%;
top:-10px;
transform:translateX(-50%);
font-size:40px;
z-index:10;
}

canvas{
background:black;
border-radius:50%;
box-shadow:0 0 30px cyan;
}

.confete{
position:fixed;
width:10px;
height:10px;
top:-10px;
animation:cair linear forwards;
}

@keyframes cair{
to{
transform:translateY(100vh) rotate(720deg);
}
}

#ranking{
margin-top:20px;
}

</style>

</head>
<body>

<h1>üéØ Roleta Profissional</h1>

<textarea id="nomes"></textarea><br>

<button onclick="salvar()">Salvar</button>
<button onclick="girar()">Girar</button>
<button onclick="resetar()">Reset</button>

<br><br>

<div id="container">

<div id="seta">‚¨á</div>

<canvas id="canvas" width="400" height="400"></canvas>

</div>

<h2 id="resultado"></h2>

<div id="ranking">
<h3>üèÜ Ranking:</h3>
<div id="listaRanking"></div>
</div>

<audio id="tic">
<source src="https://www.soundjay.com/mechanical/sounds/mechanical-clonk-1.mp3">
</audio>

<audio id="win">
<source src="https://www.soundjay.com/human/sounds/applause-01.mp3">
</audio>

<script>

const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");

let nomes=[];
let ranking=[];

let anguloAtual=0;
let velocidade=0;
let girando=false;

const cores=[
"#ff0000","#00ff00","#0000ff",
"#ffff00","#ff00ff","#00ffff",
"#ff8800","#00ff88"
];

function salvar(){

nomes=document.getElementById("nomes").value
.split("\n")
.filter(n=>n.trim()!="");

localStorage.setItem("nomes",JSON.stringify(nomes));

desenhar();

}

function carregar(){

let salvo=localStorage.getItem("nomes");
let rank=localStorage.getItem("ranking");

if(salvo){

nomes=JSON.parse(salvo);

document.getElementById("nomes").value=nomes.join("\n");

}

if(rank){

ranking=JSON.parse(rank);

mostrarRanking();

}

desenhar();

}

function desenhar(){

if(nomes.length==0)return;

let ang=2*Math.PI/nomes.length;

ctx.clearRect(0,0,400,400);

for(let i=0;i<nomes.length;i++){

ctx.beginPath();

ctx.moveTo(200,200);

ctx.arc(200,200,200,i*ang,(i+1)*ang);

ctx.fillStyle=cores[i%cores.length];

ctx.fill();

ctx.save();

ctx.translate(200,200);

ctx.rotate(i*ang+ang/2);

ctx.fillStyle="white";

ctx.font="bold 16px Arial";

ctx.fillText(nomes[i],100,5);

ctx.restore();

}

}

function girar(){

if(girando||nomes.length==0)return;

girando=true;

velocidade=Math.random()*0.3+0.4;

animar();

}

function animar(){

anguloAtual+=velocidade;

velocidade*=0.985;

canvas.style.transform=`rotate(${anguloAtual}rad)`;

if(Math.random()<0.2){

document.getElementById("tic").play();

}

if(velocidade<0.002){

finalizar();

return;

}

requestAnimationFrame(animar);

}

function finalizar(){

let angulo=anguloAtual%(2*Math.PI);

let setor=(2*Math.PI)/nomes.length;

let indice=Math.floor((2*Math.PI-angulo)/setor)%nomes.length;

let vencedor=nomes[indice];

document.getElementById("resultado").innerText=
"üèÜ "+vencedor;

document.getElementById("win").play();

confete();

// adiciona ao ranking
ranking.push(vencedor);

localStorage.setItem("ranking",JSON.stringify(ranking));

mostrarRanking();

// remove automaticamente
nomes.splice(indice,1);

localStorage.setItem("nomes",JSON.stringify(nomes));

desenhar();

girando=false;

}

function mostrarRanking(){

let div=document.getElementById("listaRanking");

div.innerHTML="";

ranking.forEach((nome,i)=>{

div.innerHTML+=(i+1)+". "+nome+"<br>";

});

}

function confete(){

for(let i=0;i<100;i++){

let c=document.createElement("div");

c.className="confete";

c.style.left=Math.random()*100+"vw";

c.style.background=
cores[Math.floor(Math.random()*cores.length)];

c.style.animationDuration=
(Math.random()*3+2)+"s";

document.body.appendChild(c);

setTimeout(()=>c.remove(),5000);

}

}

function resetar(){

localStorage.removeItem("nomes");
localStorage.removeItem("ranking");

nomes=[];
ranking=[];

document.getElementById("nomes").value="";
document.getElementById("resultado").innerText="";
document.getElementById("listaRanking").innerHTML="";

ctx.clearRect(0,0,400,400);

}

carregar();

</script>

</body>
</html>
